
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OXO Full Playlist Editor</title>
  <style>
    body { font-family: monospace; padding: 20px; background: #111; color: #eee; }
    h2 { color: #7fffd4; }
    label { display: inline-block; width: 120px; vertical-align: top; }
    textarea, input { width: 80%; background: #222; color: #eee; border: 1px solid #444; padding: 4px; margin-bottom: 10px; }
    textarea { height: 40px; }
    .section { margin-bottom: 20px; border-bottom: 1px dashed #555; padding-bottom: 10px; }
    .day { margin-bottom: 20px; background: #1e1e1e; padding: 10px; border: 1px solid #444; }
    .json-output { background: #222; color: #0f0; padding: 10px; margin-top: 20px; white-space: pre-wrap; }
    button { background: #333; color: #fff; padding: 8px 16px; border: none; cursor: pointer; margin: 5px; }
    button:hover { background: #555; }
    input.date { width: 160px; }
  </style>
</head>
<body>

<h1>OXO Full Playlist Editor</h1>

<div>
  <label>Import from index.html:</label>
  <input type="file" id="indexFileInput">
</div>

<div>
  <label>Add custom date:</label>
  <input class="date" type="text" id="customDate" placeholder="yyyy-mm-dd">
  <button onclick="addDate()">âž• Add</button>
</div>

<div id="editor"></div>

<button onclick="generateJSON()">ðŸ“¦ Export JSON</button>

<pre id="output" class="json-output"></pre>

<script>
  const sectionNames = ["Happy_Hour", "Standard_1", "DJ", "Standard_2"];
  const defaultDays = ["default", "1", "2", "3", "4", "5", "6", "7"];
  const schedule = {};

  function createEditor(day) {
    const div = document.createElement("div");
    div.className = "day";
    div.id = "day_" + day;

    const title = document.createElement("h2");
    title.textContent = (day === "default" ? "Default (Fallback)" :
      isNaN(day) ? `Date: ${day}` : `Day ${day}`);
    div.appendChild(title);

    sectionNames.forEach(section => {
      const sec = document.createElement("div");
      sec.className = "section";

      const label = document.createElement("label");
      label.textContent = section;
      sec.appendChild(label);

      const textarea = document.createElement("textarea");
      textarea.id = `${day}_${section}`;
      textarea.placeholder = "Comma-separated video list";
      sec.appendChild(textarea);

      div.appendChild(sec);
    });

    document.getElementById("editor").appendChild(div);
  }

  function generateJSON() {
    const json = {};
    document.querySelectorAll(".day").forEach(dayDiv => {
      const dayKey = dayDiv.id.replace("day_", "");
      json[dayKey] = {};

      sectionNames.forEach(section => {
        const val = document.getElementById(`${dayKey}_${section}`).value;
        if (val.trim()) {
          json[dayKey][section] = val.split(",").map(s => s.trim());
        }
      });
    });

    document.getElementById("output").textContent = JSON.stringify(json, null, 2);
  }

  function addDate() {
    const date = document.getElementById("customDate").value.trim();
    if (!date.match(/^\d{4}-\d{2}-\d{2}$/)) {
      alert("Invalid date format. Use yyyy-mm-dd");
      return;
    }
    if (document.getElementById("day_" + date)) {
      alert("Date already exists!");
      return;
    }
    createEditor(date);
  }

  document.getElementById("indexFileInput").addEventListener("change", function(event) {
    const reader = new FileReader();
    reader.onload = function(e) {
      const text = e.target.result;
      const match = text.match(/const schedule = ({[\s\S]+?});/);
      if (match) {
        try {
          const imported = eval("(" + match[1] + ")");
          for (const [day, sections] of Object.entries(imported)) {
            if (!document.getElementById("day_" + day)) createEditor(day);
            for (const [section, videos] of Object.entries(sections)) {
              const input = document.getElementById(`${day}_${section}`);
              if (input) input.value = videos.join(", ");
            }
          }
          alert("Schedule imported from index.html!");
        } catch (e) {
          alert("Failed to parse schedule.");
        }
      } else {
        alert("No schedule found in the file.");
      }
    };
    reader.readAsText(event.target.files[0]);
  });

  defaultDays.forEach(createEditor);
</script>

</body>
</html>
