<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Playlist Editor Full</title>
  <style>
    body { font-family: monospace; background: #111; color: #eee; padding: 1rem; }
    input, button, select, textarea { font-family: monospace; margin: 0.2rem; }
    table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
    th, td { border: 1px solid #444; padding: 0.3rem; vertical-align: top; }
    th { background: #222; }
    .json-box { width: 100%; height: 200px; background: #000; color: #0f0; }
  </style>
</head>
<body>

<h2>üéõÔ∏è Playlist Editor Full</h2>

<label for="newDate">‚ûï Aggiungi data (formato YYYY-MM-DD):</label>
<input type="text" id="newDate" placeholder="2025-06-01">
<button onclick="addCustomDate()">Aggiungi</button>

<div id="tableContainer"></div>

<button onclick="exportToIndex()">üì§ Esporta come index.html</button>

<h3>üì¶ Codice <code>schedule</code> generato:</h3>
<textarea id="output" class="json-box" readonly></textarea>

<script>
const sections = ["Happy_Hour", "Standard_1", "DJ", "Standard_2"];
let schedule = {
  "1": {}, "2": {}, "3": {}, "4": {}, "5": {}, "6": {}, "7": {},
  "default": {
    "Happy_Hour": [],
    "Standard_1": [],
    "DJ": [],
    "Standard_2": []
  }
};

function renderTable() {
  const container = document.getElementById("tableContainer");
  container.innerHTML = "";

  const table = document.createElement("table");
  const header = document.createElement("tr");
  header.innerHTML = "<th>Giorno</th>" + sections.map(s => `<th>${s}</th>`).join("");
  table.appendChild(header);

  Object.keys(schedule).forEach(day => {
    const row = document.createElement("tr");
    const label = isNaN(day) ? day : `Giorno ${day}`;
    row.innerHTML = `<td>${label}</td>`;
    sections.forEach(section => {
      const cell = document.createElement("td");
      const input = document.createElement("input");
      input.type = "text";
      input.style = "width: 100%";
      input.value = (schedule[day][section] || []).join(", ");
      input.onchange = () => {
        schedule[day][section] = input.value.split(",").map(x => x.trim()).filter(x => x);
        updateOutput();
      };
      cell.appendChild(input);
      row.appendChild(cell);
    });
    table.appendChild(row);
  });

  container.appendChild(table);
  updateOutput();
}

function addCustomDate() {
  const newDate = document.getElementById("newDate").value.trim();
  if (!/^\d{4}-\d{2}-\d{2}$/.test(newDate)) {
    alert("Formato data non valido (usa YYYY-MM-DD)");
    return;
  }
  if (schedule[newDate]) {
    alert("La data esiste gi√†!");
    return;
  }
  schedule[newDate] = {};
  renderTable();
}

function updateOutput() {
  document.getElementById("output").value = "const schedule = " + JSON.stringify(schedule, null, 2) + ";";
}

function exportToIndex() {
  const full = `
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>OXO Scheduler</title>
</head>
<body>
<script>
const schedule = ${JSON.stringify(schedule, null, 2)};
</script>
</body>
</html>
  `.trim();
  navigator.clipboard.writeText(full).then(() => {
    alert("index.html copiato negli appunti!");
  });
}

renderTable();
</script>

</body>
</html>
